<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Our web and mobile enabled electric blanket using Electric Ireland's Efergy RC sockets | Cross Dominant</title><meta name="description" content="Take some simple RC electric sockets that arrive in the post from Electric Ireland and make them web-powered, with almost no effort."><link rel="shortcut icon" href="/favicon.ico"><link rel="alternate" type="application/rss+xml" title="Cross DominantRSS Feed" href="/feed/"><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lato:400,300,300italic,400italic,700,700italic"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lekton"><link rel="stylesheet" href="/css/main.css"><script src="/js/prism.js"></script><!--[if lt IE 9]><script src="/js/html5shiv.js"></script><![endif]--><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-88610-4']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

</script><meta property="og:title" content="Our web and mobile enabled electric blanket using Electric Ireland's Efergy RC sockets | Cross Dominant"><meta property="og:type" content="article"><meta property="og:description" content="Take some simple RC electric sockets that arrive in the post from Electric Ireland and make them web-powered, with almost no effort."><meta property="og:url" content="http://conoroneill.net//undefined"><meta property="og:image" content="http://conoroneill.net//images/logo.png"><meta property="og:site_name" content="Cross Dominant"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@conoro"><body class="page-our-web-and-mobile-enabled-electric-blanket-using-electric-irelands-efergy-rc-sockets our-web-and-mobile-enabled-electric-blanket-using-electric-irelands-efergy-rc-sockets"><header class="masthead"><div class="container"><h1><a href="/">Cross Dominant</a></h1></div><div class="search-box"><script type="text/javascript">(function() {
  var cx = '001461447920948202874:5htheqgvd1w';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();</script><gcse:search></gcse:search></div></header><div class="content"><div class="container"><article class="post"><h1 class="lg title">Our web and mobile enabled electric blanket using Electric Ireland's Efergy RC sockets</h1><h2 class="sm date">23 Mar 2014</h2><p>A major ongoing struggle in our household is convincing one of our many children to go upstairs and put on the electric blanket for us. I honestly don&#39;t know how we get through the winter.</p>
<p>Wouldn&#39;t it be fantastic if we could use technology instead of children to do this?</p>
<p>Last Thursday I came home from work to discover that <a href="http://www.electricireland.ie/">Electric Ireland</a> had sent us three <a href="http://efergy.com/eu/products/remotecontrolledsocket">Efergy</a> remote control power sockets and a plugin energy monitor. I have no idea why they did so, apart perhaps from our crazy electricity use.</p>
<p><img src="https://s3-eu-west-1.amazonaws.com/conoroneill.net/wp-content/uploads/2014/03/efergy01.jpg" alt="Efergy" title="Efergy RC Switch"></p>
<p>My mind immediately leaped to our electric blanket conundrum.</p>
<p>A quick look at the label and I was pleased to see they worked at 433Mhz. What were the chances that the <a href="http://dx.com/p/433mhz-wireless-transmitter-module-superregeneration-for-arduino-green-149254">$1.99 wireless modules</a> I bought from DX in China would work with them? Oh the joy to discover that, not only do the modules work with them, some genius has already built <a href="https://code.google.com/p/rc-switch/">a powerful Arduino library</a> to do so! </p>
<p>It turns out that the Efergy brand uses the same simple protocol as a wide range of others around the world. I guess they are all OEMing something.</p>
<p>A 2 minute setup on my Arduino Uno with a receiver and the relevant sniffer code loaded up and I had the 11 codes (5 on, 5 off, 1 all-off) that my specific remote control used. They are all 24bit, protocol &quot;1&quot; with 6 decimal digits like 109223. I assume they distribute a range of remotes to avoid neighbours clashing. The RC switches themselves are not locked to a specific code, they have to be set by the remote control at power up.</p>
<p>2 more minutes to setup a transmitter to cycle between the codes and I was toggling the RC switches on and off. </p>
<p>I really was gobsmacked how easy it was. It was a lovely reminder of how incredible the internet really is. We&#39;ve become so used to it, we forget that the above would have taken me months (or never!) in pre-internet days instead of 10 minutes total.</p>
<p>Of course that was just step 1. What I really wanted to do was internet-enable these beauties. I&#39;ve been meaning to do something along these lines with the <a href="http://digistump.com/products/50">DigiX</a> board since I got it. The DigiX is a really powerful Arduino clone with a 32-bit Atmel ARM CPU, tons upon tons of IO, SD card, audio and, most importantly for this project, Wifi on-board.</p>
<p><img src="https://s3-eu-west-1.amazonaws.com/conoroneill.net/wp-content/uploads/2014/03/digix01.jpg" alt="frontside" title="DigiX with module"></p>
<p>Getting Wifi setup the way I wanted on the DigiX took more time than I&#39;d have liked yesterday but I finally figured out that the <a href="http://en.usr.cn/low-power-wifi-module.html">Chinese USR-wifi232-g module</a> web UI doesn&#39;t like Chrome! Once I switched to Firefox, all went swimmingly. I connected it to a Wifi AP, gave it a fixed IP address and then setup a port forward from the house router to it. Obviously I use <a href="http://dyn.com/">Dynamic DNS with Dyn</a> on the home router so that I don&#39;t have to track changing IP addresses manually.</p>
<p><img src="https://s3-eu-west-1.amazonaws.com/conoroneill.net/wp-content/uploads/2014/03/digix02.jpg" alt="backside" title="DigiX other side"></p>
<p>The DigiX comes with an example Web Server built-in so I was able to just create a few simple URLs and paste the RCSwitch code into the relevant places. So within another few minutes I was toggling the switches over the internet.</p>
<pre><code>switch1State = 1;
mySwitch.send(109323, 24);</code></pre>
<p>Another moment when I forced myself to stop and think about how incredibly easy all this stuff has become. And all of it sitting on the shoulders of giants. So far, all I&#39;ve done is copy and paste stuff together.</p>
<p>But of course I wasn&#39;t happy there. I wanted a mobile app! Luckily, Colum Bennet in <a href="http://www.feedhenry.com">FeedHenry</a> has created a superb new Getting Started guide which will be released soon. It walks you through creating an <a href="http://angularjs.org/">Angular</a> Hybrid mobile app which talks to a FeedHenry Node.js back-end to do a really simple task. Despite only playing a programmer for the purposes of blogging, I was able to easily modify both the client and cloud apps to create what I needed with the Node request module.</p>
<p><img src="https://s3-eu-west-1.amazonaws.com/conoroneill.net/wp-content/uploads/2014/03/app01.jpg" alt="Angular" title="FeedHenry Angular App"></p>
<p>Of course I could send the commands directly from the mobile app to the DigiX, but routing it through the cloud means that eventually this can be multi-user, multi-switch, re-configurable and securely locked-down.</p>
<p><img src="https://s3-eu-west-1.amazonaws.com/conoroneill.net/wp-content/uploads/2014/03/app02.jpg" alt="Success" title="Mobile App Success"></p>
<p>One really nice feature of the FeedHenry platform is that you can generate hosted Web Apps from your mobile Apps. This means that whilst I now have a lovely Android APK on my Galaxy S4, my wife can use the web app on her iPhone to achieve exactly the same thing using a simple bookmarked CNAME.</p>
<p><img src="https://s3-eu-west-1.amazonaws.com/conoroneill.net/wp-content/uploads/2014/03/webapp.jpg" alt="Web App" title="FeedHenry Web App"></p>
<p>I&#39;ll upload everthing on to a public GitHub repo as soon as I have removed all the hard-coding and added a modicum of &quot;security&quot; with API keys etc. More posts on this technology combo coming in the next few weeks.</p>
<p>With the Bandon Bed Button, we have now achieved Electric Blanket Nirvana.</p>
<section class="comments"><h2>Discuss</h2><div id="disqus_thread"><script>var disqus_shortname = 'crossdominant';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></div></section><nav class="post-nav"><ul class="clearfix"><li><a href="the-nitty-gritty-of-moving-from-wordpress-to-harpjs" title="The nitty-gritty of moving from WordPress to HarpJS" class="post-prev"><strong>Previous Post</strong><span>The nitty-gritty of moving from WordPress to HarpJS</span></a></li><li><a href="interfacing-nodejs-to-raspberry-pi-hardware-with-node-ffi" title="Interfacing Node.js to Raspberry Pi hardware like 433Mhz transmitters with node-ffi" class="post-next"><strong>Next Post</strong><span>Interfacing Node.js to Raspberry Pi hardware like 433Mhz transmitters with node-ffi</span></a></li></ul></nav></article></div></div></body></head></html>